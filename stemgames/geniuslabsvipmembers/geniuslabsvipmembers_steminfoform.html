<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6LCJRQRK8L"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-6LCJRQRK8L');
    </script>

    <meta charset="UTF-8">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
        content="Robotics. Coding. AI Everyone is talking about them | Only a few are building them | Explore the STEM Program." />
    <meta name="keywords"
        content="Robotics, Coding, ChatGpt, Artificial Intelligence, Space, NASA, ISRO, STEM Programs for children" />
    <meta name="author" content="Genius Labs" />
    <meta name="robots" content="index, follow" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="icon" href="../images/favicon.png" type="image/x-icon" />
    <title>Genius Labs STEM Brilliance Program for children 6-14 yrs | Offering both online and offline modules </title>
    <!-- Include Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="/stemgames/css/bootstrap.css">
    <!-- Include your custom CSS files -->
    <link rel="stylesheet" type="text/css" href="geniuslabsvipmembers_steminfoform.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
    <!-- Include Google Fonts -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400&display=swap" />
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Nunito' />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Barlow:wght@500&display=swap" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;600;700;800&display=swap" />

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Avenir">
    <!-- Meta Pixel Code -->
    <script>
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                    n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = []; t = b.createElement(e); t.async = !0;
            t.src = v; s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }(window, document, 'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '1780175095749858');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
            src="https://www.facebook.com/tr?id=1780175095749858&ev=PageView&noscript=1" /></noscript>
    <!-- End Meta Pixel Code -->
</head>


<body class="custom-bg">
    <!--Back-Button-->
    <div class="container">
        <div class="row ">
            <div class="col">
                <a href="./geniuslabsvipmembers_childstempreferences.html" class=" arrowbutton" type="button">
                    <img src="../public/backarrow.png" class="arrow img-fluid"
                        alt="geniuslabs stem learning spaces for k-14 backarrow to toggle the previous page">
                </a>
            </div>
            <div class="col-4">
                <img src="../public/logo.webp" class="logo img-fluid "
                    alt="geniuslabs stem learning spaces for k-14 logo">
            </div>
        </div>
    </div>
    <div class="for-desktop">
        <div class="container-fluid">
            <div class="row">
                <div class="col">
                    <div class="done">
                        <span class="we-are-done">VIP Membership Process ...</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="progres-bar">
                        <div class="progress-bar-child"></div>
                        <div class="progress-bar-item"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="almostdone">
                        <span>Almost Done</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <form id="myForm" method="post" action="/">
                        <div class="human-logo-1-parent">
                            <img class="human-logo-1" alt="geniuslabs stem learning spaces for k-14 your name logo"
                                src="../public/human-logo-1@2x.png" />

                            <label class="your-name">Your Name</label>
                            <label class="contact-details">Contact Details</label>
                            <label class="child-current-school">Child Current School</label>
                            <img class="location-logo-1"
                                alt="geniuslabs stem learning spaces for k-14 your location logo"
                                src="../public/location-logo-1@2x.png" />

                            <img class="home-logo-1"
                                alt="geniuslabs stem learning spaces for k-14 your child school logo"
                                src="../public/home-logo-1@2x.png" />

                            <img class="phone-logo-1"
                                alt="geniuslabs stem learning spaces for k-14 your phone number logo"
                                src="../public/phone-logo-1@2x.png" />

                            <label class="location">Location</label>
                            <input required class=" frame-child3" type="text" name="ChildName">

                            <input required class="frame-child4" type="tel" name="ContactNo" id="contactDetails"
                                oninput="validatePhoneNumber()">

                            <input required class="frame-child5" type="text" name="ChildSchool">

                            <select required class="frame-child6" id="locationSelect" name="Location">
                                <option value="" disabled selected>Select a location</option>
                                <option value="Agra">Agra</option>
                                <option value="Ahmedabad">Ahmedabad</option>
                                <option value="Ajmer">Ajmer</option>
                                <option value="Aligarh">Aligarh</option>
                                <option value="Allahabad">Allahabad</option>
                                <option value="Ambattur">Ambattur</option>
                                <option value="Amravati">Amravati</option>
                                <option value="Amritsar">Amritsar</option>
                                <option value="Asansol">Asansol</option>
                                <option value="Aurangabad">Aurangabad</option>
                                <option value="Bangalore">Bangalore</option>
                                <option value="Bareilly">Bareilly</option>
                                <option value="Belgaum">Belgaum</option>
                                <option value="Bhavnagar">Bhavnagar</option>
                                <option value="Bhilai Nagar">Bhilai Nagar</option>
                                <option value="Bhiwandi">Bhiwandi</option>
                                <option value="Bhopal">Bhopal</option>
                                <option value="Bhubaneswar">Bhubaneswar</option>
                                <option value="Bikaner">Bikaner</option>
                                <option value="Chandigarh">Chandigarh</option>
                                <option value="Chennai">Chennai</option>
                                <option value="Coimbatore">Coimbatore</option>
                                <option value="Cuttack">Cuttack</option>
                                <option value="Dehradun">Dehradun</option>
                                <option value="Delhi">Delhi</option>
                                <option value="Dhanbad">Dhanbad</option>
                                <option value="Durgapur">Durgapur</option>
                                <option value="Faridabad">Faridabad</option>
                                <option value="Firozabad">Firozabad</option>
                                <option value="Gaya">Gaya</option>
                                <option value="Ghaziabad">Ghaziabad</option>
                                <option value="Gorakhpur">Gorakhpur</option>
                                <option value="Gulbarga">Gulbarga</option>
                                <option value="Guntur">Guntur</option>
                                <option value="Gurgaon">Gurgaon</option>
                                <option value="Guwahati">Guwahati</option>
                                <option value="Gwalior">Gwalior</option>
                                <option value="Haora">Haora</option>
                                <option value="Hubli and Dharwad">Hubli and Dharwad</option>
                                <option value="Hyderabad">Hyderabad</option>
                                <option value="Indore">Indore</option>
                                <option value="Jabalpur">Jabalpur</option>
                                <option value="Jaipur">Jaipur</option>
                                <option value="Jalandhar">Jalandhar</option>
                                <option value="Jalgaon">Jalgaon</option>
                                <option value="Jammu">Jammu</option>
                                <option value="Jamnagar">Jamnagar</option>
                                <option value="Jamshedpur">Jamshedpur</option>
                                <option value="Jhansi">Jhansi</option>
                                <option value="Jodhpur">Jodhpur</option>
                                <option value="Kalyan and Dombivali">Kalyan and Dombivali</option>
                                <option value="Kanpur">Kanpur</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="Kochi">Kochi</option>
                                <option value="Kolapur">Kolapur</option>
                                <option value="Kolkata">Kolkata</option>
                                <option value="Kota">Kota</option>
                                <option value="Loni">Loni</option>
                                <option value="Lucknow">Lucknow</option>
                                <option value="Ludhiana">Ludhiana</option>
                                <option value="Option">Madurai</option>
                                <option value="Madurai">Maheshtala</option>
                                <option value="Malegoan">Malegoan</option>
                                <option value="Mangalore">Mangalore</option>
                                <option value="Meerut">Meerut</option>
                                <option value="Mira and Bhayander">Mira and Bhayander</option>
                                <option value="Moradabad">Moradabad</option>
                                <option value="Mumbai">Mumbai</option>
                                <option value="Nagpur">Nagpur</option>
                                <option value="Nanded Waghala">Nanded Waghala</option>
                                <option value="Nashik">Nashik</option>
                                <option value="Navi Mumbai">Navi Mumbai</option>
                                <option value="Nellore">Nellore</option>
                                <option value="Noida">Noida</option>
                                <option value="Patna">Patna</option>
                                <option value="Pimpri and Chinchwad">Pimpri and Chinchwad</option>
                                <option value="Pune">Pune</option>
                                <option value="Raipur">Raipur</option>
                                <option value="Rajkot">Rajkot</option>
                                <option value="Ranchi">Ranchi</option>
                                <option value="Saharanpur">Saharanpur</option>
                                <option value="Salem">Salem</option>
                                <option value="Sangli Miraj Kupwad">Sangli Miraj Kupwad</option>
                                <option value="Siliguri">Siliguri</option>
                                <option value="Solapur">Solapur</option>
                                <option value="Srinagar">Srinagar</option>
                                <option value="Surat">Surat</option>
                                <option value="Thane">Thane</option>
                                <option value="Thiruvananthapuram">Thiruvananthapuram</option>
                                <option value="Tiruchirappalli">Tiruchirappalli</option>
                                <option value="Tirunelveli">Tirunelveli</option>
                                <option value="Udaipur">Udaipur</option>
                                <option value="Ujjain">Ujjain</option>
                                <option value="Ulhasnagar">Ulhasnagar</option>
                                <option value="Vadodara">Vadodara</option>
                                <option value="Varanasi">Varanasi</option>
                                <option value="Vasai Virar">Vasai Virar</option>
                                <option value="Vijayawada">Vijayawada</option>
                                <option value="Visakhapatnam">Visakhapatnam</option>
                                <option value="Warangal">Warangal</option>
                                <option value="Others">Others</option>
                            </select>
                            <input type="text" name="CustomLocation" class="frame-child6" id="customLocation"
                                style="display: none;" placeholder="Enter custom location">

                            <div class="frame-child7"></div>
                            <div class="div">+91</div>
                        </div>
                        <!-- <button type="submit" class="genius-labs-website-games-se6">
            <b class="submit">SUBMIT</b>
            <button  class="roundarrow-11"></button>
            </button> -->
                        <!-- <button class="submit-parent btn" type="submit">
                  <b class="submit">SUBMIT</b>
                  <img class="roundbtn-submit img-fluid" alt="" src="../public/roundarrow1@3x.png" />
                </button> -->
                        <button id="submitButton" class="submit-parent" type="submit">
                            <b class="submit">GET OTP</b>
                            <img class="img-fluid align-items-lg-stretch mask-group-icon"
                                alt="geniuslabs stem learning spaces for k-14 backarrow to toggle the next page"
                                src="../public/mask-group@2x.png" />
                        </button>
                    </form>

                </div>
                <div class="col-md-4">
                    <div id="otp-section" style="display: none;">
                        <input class="otpinput" type="number" id="otp" length="4" placeholder="   Enter Otp">
                        <button class="otp" type="button" onclick="verifyOtp()"> <b
                                class="verifyotp">SUBMIT</b></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        //const scriptURL = 'https://script.google.com/macros/s/AKfycbxQKkI9JsRz7HqYx4e6zciIdZ6I1EAF0I2SYthStVMyKmbTyixEquMx_6gEg8drjYur/exec'
        const scriptURL = '/form';
        const form = document.querySelector('#myForm')
        const selectableItems = document.querySelectorAll('.selectable');
        const selectedOptionsContainer = document.querySelector('.selected-options');
        let contactNumber = null;
        form.addEventListener('submit', async e => {
            e.preventDefault();

            const submitButton = document.getElementById("submitButton");
            if (submitButton) {
                submitButton.disabled = true;
            }


            const YourChildAge = sessionStorage.getItem('ChildAge');
            const selectedOptions = JSON.parse(sessionStorage.getItem('selectedOptions'));
            if (YourChildAge !== null && selectedOptions !== null && form.checkValidity()) {

                console.log(YourChildAge)
                console.log(selectedOptions)
                const formData = new FormData(form);
                formData.append('ChildAge', YourChildAge);
                //formData.append('SelectedOptions',JSON.stringify(selectedOptions))
                const locationSelect = document.getElementById("locationSelect");
                const customLocationInput = document.getElementById("customLocation");

                // Handle the location based on the user's selection
                if (locationSelect.value === "Others") {
                    formData.set('Location', customLocationInput.value); // Use the same name for both custom and selected location
                } else {
                    formData.set('Location', locationSelect.value); // Use the same name for both custom and selected location
                }
                formData.append('Interest', Array.isArray(selectedOptions) ? selectedOptions.join(', ') : '');


                try {
                    const response = await fetch(scriptURL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(Object.fromEntries(formData.entries()))
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    const contentType = response.headers.get('content-type');    //new line 
                    if (contentType && contentType.includes('application/json')) {   //new line

                        const data = await response.json();
                        console.log('Server Response:', response);
                        console.log('Server Response:', data); // new line 

                        if (data.result === 'success') {
                            contactNumber = document.querySelector('#contactDetails').value;
                            alert('Success! Enter your Valid Otp');
                            // form.reset();
                            // resetForm();
                            showOtpSection()
                        }

                        else {
                            alert('Error submitting data. Please try again.');
                            console.error('Server error:', data.error);
                            //showErrorPage()
                            // window.location.href = 'errorpage.html';
                        }
                    } else {
                        console.log('hii');
                        console.error('Unexpected response format:', contentType); //new line
                    }
                } catch (error) {
                    alert('An error occurred while submitting the form.');
                    //showErrorPage()
                    //window.location.href = 'errorpage.html';
                    console.error('Fetch error:', error);
                }
            } else {
                console.error('Selected age or option not found in sessionStorage');
            }
        });

        function validatePhoneNumber() {
            const contactDetailsInput = document.getElementById('contactDetails');
            const phoneNumber = contactDetailsInput.value.replace(/\D/g, ''); // Remove non-digit characters

            // Validate 10-digit phone number
            if (phoneNumber.length === 10 && /^[6-9]\d{9}$/.test(phoneNumber)) {
                // Check for uniqueness
                const existingPhoneNumbers = JSON.parse(sessionStorage.getItem('phoneNumbers')) || [];
                if (false && existingPhoneNumbers.includes(phoneNumber)) {
                    contactDetailsInput.setCustomValidity('This phone number is already used.');
                } else {
                    contactDetailsInput.setCustomValidity('');
                    existingPhoneNumbers.push(phoneNumber);
                    sessionStorage.setItem('phoneNumbers', JSON.stringify(existingPhoneNumbers));
                }
            } else {
                contactDetailsInput.setCustomValidity('Please enter a valid 10-digit phone number.');
            }
        }

        const locationSelect = document.getElementById("locationSelect");
        const customLocationInput = document.getElementById("customLocation");

        locationSelect.addEventListener("change", function () {
            if (locationSelect.value === "Others") {
                customLocationInput.style.display = "block";
                customLocationInput.setAttribute("required", "required");
            } else {
                customLocationInput.style.display = "none";
                customLocationInput.removeAttribute("required");
            }
        });

        function resetForm() {
            // Clear selected options
            sessionStorage.removeItem('selectedOptions');
            sessionStorage.removeItem('ChildAge');

            // Remove 'selected' class from all selectable items
            selectableItems.forEach(item => {
                item.classList.remove('selected');
            });

            //selectedOptionsContainer.innerHTML = '';
        }

        function showOtpSection() {
            document.querySelector('#otp-section').style.display = "";
        }

        async function verifyOtp() {
            const otp = document.querySelector('#otp').value;
            if (!otp) {
                alert('Enter OTP!');
                return;
            }

            try {
                const response = await fetch('/verify-otp', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ contactNumber, otp })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                const data = await response.json();

                if (data.error) {
                    alert(`Error verifying OTP: ${data.error}`);
                } else {
                    alert('Your Data is Submitted Successfully');
                    form.reset();
                    resetForm();
                    window.location.href = 'geniuslabsvipmembers_stemvipdone.html';
                }
            } catch (error) {
                console.error('Error verifying OTP:', error);
                alert('Error verifying OTP. Please try again.');
            }
        }


        // function showErrorPage() {
        //   const errorIframe = document.getElementById('errorIframe'); // Get the iframe element by its id
        //       errorIframe.style.display = 'block'; // Show the error page iframe
        //       document.querySelector('.android-large-14').style.display = 'none'; // Hide the main content
        // }


    </script>


    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
        integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
        crossorigin="anonymous"></script>
</body>

</html>